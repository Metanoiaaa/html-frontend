<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>Recept details</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="css/styles.css" rel="stylesheet">

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>

</head>
<body>
<style>
    h2{
        font-size:16px;
        font-weight:bold;
        margin-bottom: 0px;
    }

    input[type=text-h1] {
        text-align: left;
        word-wrap: break-word;
        word-break: break-all;
        height: 80px;
        font-weight: bold;
        font-size:larger;
        margin-left: 18px;
    }

    div{
      border: 0px;
      border-color: white;
    }

    img {
    border-radius: 50%;
    }

    /* input{
      width: auto;
      height: auto;
      word-wrap: break-word;
      word-break: break-all;
      overflow-wrap: break-word;
    } */
</style>
<!-- Begin header -->
<body>
    <div class="container-fluid onze-header">
        <nav class="navbar navbar-expand">
            <div class="container-fluid">
                <a class="navbar-brand" href="index.html">
                    <img src="img/logo.png" class="img-fluid logo" alt="Recepten Database"/>
                </a>
            </div>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
                aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link" aria-current="page" href="index.html">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="Recepten.html">Recepten</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown"
                            aria-expanded="false">
                            Recepten Bewerken
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="ReceptToevoegen.html">Toevoegen</a></li>
                            <li><a class="dropdown-item" href="Recept-aanpassen.html">Aanpassen</a></li>
                        </ul>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown"
                            aria-expanded="false">
                            <i class="fa-solid fa-circle-user"></i>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="Gebruikers.html">Mijn Account</a></li>
                            <li><a class="dropdown-item" href="GebruikersAanmaken.html">Account aanmaken</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </nav>
        <div class="header">
            <div class="search">
                <div class="input-group">
                    <span class="input-group-text"><i class="fa-solid fa-magnifying-glass"></i></span>
                    <input type="text" class="form-control" placeholder="Zoek recept..">
                </div>
            </div>
        </div>
    </div>

    <div class="table">
        <label for="id">ReceptID:</label>
        <input type="text" id="id" name="id" placeholder="Vul ReceptID in."><br><br>
        <button type = "submit" onclick="showUpdateRecipe()">Laad recept</button>
        <br><br>
      </div>
  
      <!-- BEGIN NESTING -->
      <div class="container text-left">
        <div class="row">
          <div class="col">
            <h1>
              <!-- Receptnaam -->
              <div class="mb">
                <input type="text-h1" class="form-control-plaintext" id="title-input" name="title" placeholder="title komt hier."disabled readonly>
              </div>

      <div class="container text-left">
        <div class="row">
          <div class="col-sm-6">
            <!-- <img src="./img/header.jpg" style="object-fit:cover; width:600px; height:600px"> -->
            <input type="image" id="foto-input" style="object-fit:cover; width:600px; height:600px">
            <!-- Level 1: .col-sm-6 -->
              <div class="row">
                <div class="col-sm-4">
                  <br>
                  <img src="./img/young cap.jpeg" alt="profilepicture-admin" width="200" height="200">
                </div>
                <div class="col-sm">
                  <br><br>
                  Auteur:
                  <div class="mb-3">
                    Admin
                    <!-- <input type="text" class="form-control-plaintext" id="userId-input" name="userId" placeholder="userId wordt hier geladen."disabled readonly> -->
                  </div>
                  Gepubliceerd op:
                  <div class="mb-3">
                    <input type="text" class="form-control-plaintext" id="dateCreate-input" name="dateCreate" placeholder="dateCreate wordt hier geladen."disabled readonly><br>
                  </div>
                  <!-- <br>
                  Laatst geupdate op: dag-maand-jaar -->
              </div>
            </div>
          </div>
          <div class="col-sm-6">
            <div class="row">
              <div class="col-2 col-sm-6">
                <!-- KOLOM 2 KOMT HIER -->
                <!-- Level 2: .col-8 .col-sm-6 -->
                <div class="row row-cols-1">
                    <div class="col">
                        <i class="fa fa-star" aria-hidden="true"></i>
                        <i class="fa fa-star" aria-hidden="true"></i>
                        <i class="fa fa-star" aria-hidden="true"></i>
                        <i class="fa fa-star" aria-hidden="true"></i>
                        <i class="fa fa-star" aria-hidden="true"></i>
                    </div>
                    

                    <!-- <div class="input-group mb-2">
                      <div class="input-group-prepend">
                        <span class="input-group-text">$</span>
                      </div>
                      <input type="text" class="form-control-plaintext" id="prepTime-input" name="prepTime-input" placeholder="prepTime"disabled readonly>
                      <div class="input-group-append">
                        <span class="input-group-text"> minuten</span>
                      </div>
                    </div> -->

                    <!-- <div class="col-auto">
                      <i class="fa fa-hourglass-half" aria-hidden="true"></i>
                        <div class="col-sm-3">
                          <input type="text" class="form-control-plaintext" id="prepTime-input" name="prepTime-input" placeholder="prepTime komt hier."disabled readonly> minuten <br>
                        </div>
                    </div> -->

                    <!-- <div class="input-group mb-3">
                      <div class="input-group-prepend">
                        <span class="input-group-text">$</span>
                      </div>
                      <input type="text" class="form-control-plaintext" id="prepTime-input" aria-label="Amount (to the nearest dollar)">
                      <div class="input-group-append">
                        <span class="input-group-text">.00</span>
                      </div>
                    </div> -->
                    
                    <div class="input-group col-sm-4">
                      <div class="input-group-prepend ">
                        <span class="input-group-text"><i class="fa fa-hourglass-half" aria-hidden="true"></i></span>
                      </div>
                      
                      <div class="col-3">
                        <input type="text" class="form-control" id="prepTime-input" aria-label="Amount (to the nearest dollar)" disabled readonly>
                      </div>

                      <div class="input-group-append">
                        <span class="input-group-text">min</span>
                      </div>
                    </div>

                    <div class="col-auto">
                      <div class="col-sm-4"><h2>Barbecue</h2>
                        <input type="text" class="form-control-plaintext" id="bbqId-input" name="bbqId-input" placeholder="bbqId komt hier."disabled readonly><br>
                      </div>
                    </div>

                    <div class="col-auto">
                      <div class="col-sm-6"><h2>Dieet</h2>
                        <input type="text" class="form-control-plaintext" id="diet-input" name="diet" placeholder="diet komt hier."disabled readonly><br>
                      </div>
                    </div>
                    <div class="col"><h2>Ingredienten</h2>
                        <!-- <ul>
                            <li>Boter</li>
                            <li>Kaas</li>
                            <li>Eieren</li>
                        </ul> -->
                      <br>
                    </div>
                    <div class="col"><h2>Kookgereedschap</h2>
                        <input type="text" class="form-control-plaintext" id="cookAttireId-input" name="cookAttireId-input" placeholder="cookAttireId komt hier." disabled readonly><br>
                    </div>
                  </div>                
              </div>
              <div class="col-4 col-sm-6">
                <!-- KOLOM 3 KOMT HIER -->
                <!-- Level 2: .col-4 .col-sm-6 -->
                <div class="row row-cols-1">
                    <div class="col"><h2>Introductie</h2>
                      <div class="mb-3">
                        <textarea readonly class="form-control-plaintext" placeholder="intro komt hier" id="intro-input" style="height: auto" disabled readonly></textarea>
                        <!-- <input type="text" class="form-control-plaintext" style="object-fit:contain; width:600px; height:auto" id="intro-input" name="intro" placeholder="Introductie komt hier."disabled readonly><br> -->
                      </div>
                      <!-- Bim, bam, beieren, de koster lust geen eieren. Wat lust hij dan? Spek in de pan. O, zoo'n lekkere koster dan! -->
                    </div>
                    <div class="col"><h2>Bereiding</h2>
                      <div class="form-floating mb-3">
                        <textarea readonly class="form-control-plaintext" placeholder="prepText komt hier" id="prepText-input" style="height: 750px" disabled readonly></textarea>
                        <!-- <input type="textarea" rows="25" wrap="hard" class="form-control" id="prepText-input" name="prepText" placeholder="prepText komt hier."><br> -->
                      </div>
                  </div> 
              </div>
            </div>
          </div>
        </div>
      </div>

<!-- <div class="container text-left">
        <div class="row">
          <div class="col-sm-2">
            <br><i class="fa-solid fa-circle-user fa-10x"></i>
          </div>
          <div class="col-sm">
            <br>
            Auteur:
            <div class="mb-3">
              <input type="text" class="form-control-plaintext" id="userId-input" name="userId" placeholder="userId wordt hier geladen."disabled readonly><br>
            </div>
            <br>
            Gepubliceerd op:
            <div class="mb-3">
              <input type="text" class="form-control-plaintext" id="dateCreate-input" name="dateCreate" placeholder="dateCreate wordt hier geladen."disabled readonly><br>
            </div>
            <br>
            Laatst geupdate op: dag-maand-jaar
          </div>
        </div>
      </div> -->
      <!-- EINDE NESTING 2.0 -->
    
      <!-- <div class="table" id="UpdateRecipeTable">
        <label for="title-input" class="form-label">Naam recept</label>
        <input type="text" class="form-control" id="title-input" name="title" placeholder="Vul naam in."><br>
    
        <label for="prepTime-input" class="form-label">Kooktijd</label>
        <input type="number" class="form-control" id="prepTime-input" placeholder="Vul hier de kooktijd in."><br>
    
        <label for="rating-input" class="form-label">Rating</label>
        <input type="number" class="form-control" id="rating-input" placeholder="Vul hier de rating in."><br>
    
        <label for="bbqId-input" class="form-label">Type BBQ</label>
        <input type="number" class="form-control" id="bbqId-input" placeholder="Vul hier het type barbecue in."><br>
    
        <label for="intro-input" class="form-label">Introductie</label>
        <input type="text" class="form-control" id="intro-input" placeholder="Vul hier de introductie in."><br>
    
        <label for="prepText-input" class="form-label">Instructies</label>
        <input type="text" class="form-control" id="prepText-input" placeholder="Vul hier de instructies in."><br>
    
        <label for="cookAttireId-input" class="form-label">Benodigdheden</label>
        <input type="number" class="form-control" id="cookAttireId-input" placeholder="Vul hier de benodigdheden in."><br>
    
        <label for="userId-input" class="form-label">Geupload door</label>
        <input type="text" class="form-control" id="userId-input" placeholder="Vul hier de uploader in."><br>
    
        <label for="dateCreate-input" class="form-label">Aangemaakt op</label>
        <input type="text" class="form-control" id="dateCreate-input" placeholder="Vul hier de aanmaakdatum in."><br>
    
        <label for="foto-input" class="form-label">Foto recept</label>
        <input type="text" class="form-control" id="foto-input" placeholder="Voer hier de url naar de foto in."><br>
    
        <label for="diet-input" class="form-label">Dieetwensen recept</label>
        <input type="text" class="form-control" id="diet-input" placeholder="Voer hier de dieetwensen in."><br>
    
        <button class="btn btn-info" onclick="updateRecipe()">Update recept</button>
        <button class="btn btn-danger" onclick="verwijderRecept()">Delete recept</button>
      </div> -->
    
      <!-- DELETE RECEPT KNOP -->
      <!-- <div class="delete recipe">
        <label for="recipeID">Recept nummer (recipeId):</label>
        <input type="text" id="recipeID" name="recipeID"><br><br>
        <button onclick="verwijderRecept()">Delete recept</button>
      </div> -->
    
      <script>
        // VALIDATION
        // Example starter JavaScript for disabling form submissions if there are invalid fields
    (() => {
      'use strict'
      // Fetch all the forms we want to apply custom Bootstrap validation styles to
      const forms = document.querySelectorAll('.needs-validation')
      // Loop over them and prevent submission
      Array.from(forms).forEach(form => {
        form.addEventListener('submit', event => {
          if (!form.checkValidity()) {
            event.preventDefault()
            event.stopPropagation()
          }
          form.classList.add('was-validated')
        }, false)
      })
    })()
        // EINDE VALIDATION
        
        // COLAPSE
        function collapse() {
          showUpdateRecipe
        }
        // EINDE COLLAPSE
    
        // FILL RECIPE FORM
        function showUpdateRecipe() {
          // Haal het formulier op
         var receptID = document.getElementById("id").value
         console.log(receptID);
    
          var xhttp = new XMLHttpRequest();
           xhttp.onreadystatechange = function (){
            if (this.readyState == 4 && this.status == 200) { var response = JSON.parse(xhttp.responseText);
             console.log(response[receptID]) }
             var geladenRecept = response[receptID]
            //  console.log(typeof geladenRecept)
             Object.entries(geladenRecept).forEach(element => {
              const [key, value]=element
              console.log(key,value)
                try {
                  document.getElementById(key + "-input").value = value
                  console.log(element)
              } catch (error) {
                  console.log(error)
              }
             });
            };
            xhttp.open("GET", "https://localhost:7042/api/Recepten", true);
             xhttp.send();
          var recipeForm = document.getElementById("UpdateRecipeTable");
          UpdateRecipeTable.style.display = "block";
          // myFunction();
        }
    
        function updateRecipe() {
          //Haal de gegevens van de gebruiker op uit de inputvelden
          var receptId = document.getElementById("id").value;
          var newRecept = {};
    
          //Check welke velden zijn ingevuld en voeg deze toe aan het veld-object
          if (document.getElementById("title-input").value.trim() !== "") {
            newRecept.title = document.getElementById("title-input").value;
          }
          if (document.getElementById("userId-input").value.trim() !== "") {
            newRecept.uploaderName = document.getElementById("userId-input").value;
          }
          if (document.getElementById("prepTime-input").value.trim() !== "") {
            newRecept.prepTime = document.getElementById("prepTime-input").value;
          }
          if (document.getElementById("prepText-input").value.trim() !== "") {
            newRecept.prepText = document.getElementById("prepText-input").value;
          }
          if (document.getElementById("intro-input").value.trim() !== "") {
            newRecept.intro = document.getElementById("intro-input").value;
          }
          if (document.getElementById("foto-input").value.trim() !== "") {
            newRecept.foto = foto.replace(/["]/g, '')

            newRecept.foto = document.getElementById("foto-input").src;
          }
          if (document.getElementById("bbqId-input").value.trim() !== "") {
            newRecept.bbqID = document.getElementById("bbqId-input").value;
          }
          if (document.getElementById("cookAttireId-input").value.trim() !== "") {
            newRecept.cookAttireId = document.getElementById("cookAttireId-input").value;
          }
          if (document.getElementById("rating-input").value.trim() !== "") {
            newRecept.rating = document.getElementById("rating-input").value;
          }
          if (document.getElementById("diet-input").value.trim() !== "") {
            newRecept.diet = document.getElementById("diet-input").value;
          }
          if (document.getElementById("dateCreate-input").value.trim() !== "") {
            newRecept.dateCreate = document.getElementById("dateCreate-input").value;
          }
          console.log(JSON.stringify(newRecept))
          console.log('https://localhost:7042/api/Recepten/' + receptId)
    
          // Stuur de gegevens naar de backend via de Fetch API
          fetch('https://localhost:7042/api/Recepten/' + receptId, {
            method: "PUT",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(newRecept)
          })
            .then(response => {
              if (response.ok) {
                alert("Recept bijgewerkt");
              } else {
                alert("Er is een fout opgetreden bij het bijwerken van het recept");
              }
            })
            .catch(error => {
              console.error('Fout bij het bijwerken van het recept:', error);
            });
        }
    
        function veldenVullen() {
          fetch('https://localhost:7042/api/Recepten/')
            .then(res => {
              return res.json();
            })
            .then(data => {
              console.log(data);
            })
            .catch(error => console.log(error)
            );
        }
    
        function verwijderRecept() {
          // Bouw de SQL-query
          var recipeId = document.getElementById("id").value;
          var query = "DELETE FROM table_name WHERE id = " + recipeId;
    
          // Verwijder de gebruiker met behulp van Fetch API
          fetch('https://localhost:7042/api/Recepten/' + recipeId, {
            method: "DELETE",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({ query: query })
          })
            .then(response => {
              if (response.ok) {
                alert("Recept verwijderd");
              } else {
                alert("Er is een fout opgetreden bij het verwijderen van het recept");
              }
            })
            .catch(error => {
              console.error('Fout bij het verwijderen van het recept:', error);
            });
        }
      </script>
</body>
</html>